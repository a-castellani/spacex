<%= render "/pages/navbardark" %>

<div class="container">
<div class="d-flex justify-content-evenly m-5">
  <div>
    <%= render "spaceships/card", spaceship: @spaceship %>
  </div>
  <div>
    <% if @spaceship.photo.attached?  %>
      <%= cl_image_tag(@spaceship.photo.key, :width => 450, :height => 250, crop: :fit) %>
    <% else %>
      <%= image_tag('spaceship.jpeg', :height => 250) %>
    <% end %>
  </div>
  <div>
    <% if user_signed_in? %>
      <% if current_user.id == @spaceship.user_id %>
        <%= link_to "Edit Spaceship", edit_spaceship_path(@spaceship) %>
        <%= link_to "Delete Spaceship", spaceship_path(@spaceship), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
      <% end %>
    <% end %>
  </div>
</div>


  <p> <%= @spaceship.description %></p>
  <p>Owner: <%= @spaceship.user.first_name %> <%= @spaceship.user.last_name %></p>

  <% if user_signed_in? %>
    <% if current_user.id != @spaceship.user_id %>
      <div data-controller="displaybookingform">
        <button class="btn btn-primary" data-action="click->displaybookingform#fire">To infinity and beyond!</button>
        <div class="d-none" data-displaybookingform-target="form">
          <%= render "spaceships/booking_form"%>
        </div>
      </div>
    <% end %>
  <% else %>
    <p><strong>Want to book? You have to <%= link_to "sign in", new_user_session_path %></strong></p>
  <% end %>
</div>

<div style="width: 100%; height: 600px;"
  data-controller="map"
  data-map-markers-value="<%= @markers.to_json %>"
  data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
